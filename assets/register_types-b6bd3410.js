import{s as l,R as hs,C as m,M as S,G as y,O as vt,T as O,N as _e,g as E,a as ps,b as g,W as ds,c as ft,d as V,A as Wt,I as ms,e as q,f as us,L as fs,V as gs,h as Y,i as G,j as Gt,P as xe,k as bs,E as x,l as me,m as ue,n as H,o as ys,p as X,q as j,r as Ht,t as tt,u as Xt,v as gt,S as vs,w as wt,x as Oe,y as ws,z as _s,B as xs,D as fe,F as Pe,H as Os,J as Ps,K as ge,X as Ss,Q as Se,U as Cs,Y as Ft,Z as Ce,_ as js,$ as d,a0 as Is,a1 as w,a2 as Es,a3 as Ds,a4 as je,a5 as Rs,a6 as $s,a7 as Ie}from"./needle-engine-42735a8f.js";import{V as F,P as Ts,O as M,C as et,M as Ee,a as De,b as _,c as As,d as qt,Q as k,S as Ms,A as Ls,L as Fs,R as Bs,E as Vs}from"./three.module-8914c3c0.js";import"./index-d2032db8.js";var Us=Object.defineProperty,Ns=Object.getOwnPropertyDescriptor,Re=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ns(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Us(t,e,s),s};class Yt extends m{constructor(){super(...arguments),this.safeArea=new F(0,0)}update(){var s,n;const t=this.context.domWidth/this.safeArea.x,e=this.context.domHeight/this.safeArea.y,i=S.clamp(Math.min(t,e),0,1);(n=(s=this.rectTransform)==null?void 0:s.shadowComponent)==null||n.scale.setScalar(i)}}Re([l(hs)],Yt.prototype,"rectTransform",2);Re([l(F)],Yt.prototype,"safeArea",2);var zs=Object.defineProperty,Ws=Object.getOwnPropertyDescriptor,Jt=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ws(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&zs(t,e,s),s};class _t extends m{constructor(){super(...arguments),this.createMenuButton=!1,this.teleportVRPlayer=!1,this.ignoreYInVR=!1,this.menuButton=null}get orbitalCamera(){return this._orbitalCamera??(this._orbitalCamera=y.findObjectOfType(vt)),this._orbitalCamera}awake(){this.createMenuButton&&this.addButton()}addButton(){var i;this.menuButton&&this.removeButton();const t=((i=this.gameObject.getComponentInChildren(O))==null?void 0:i.text)??this.gameObject.name,e=document.createElement("button");this.menuButton=e,e.innerText=t.replace("_"," "),e.setAttribute("priority","40"),e.addEventListener("click",()=>this.use()),this.context.menu.appendChild(e)}removeButton(){this.menuButton&&(this.menuButton.remove(),this.menuButton=null)}use(){var e,i;(e=this.orbitalCamera)==null||e.setCameraTargetPosition(this.worldPosition);const t=(i=_e.active)==null?void 0:i.rig;if(this.teleportVRPlayer&&this.context.isInVR&&t){const s=E(this.worldPosition);this.ignoreYInVR&&(s.y=t.gameObject.worldPosition.y),t.gameObject.worldPosition=s}}}Jt([l()],_t.prototype,"createMenuButton",2);Jt([l()],_t.prototype,"teleportVRPlayer",2);Jt([l()],_t.prototype,"ignoreYInVR",2);class Gs extends m{constructor(){super(...arguments),this.cam=null}onEnable(){this.cam=this.gameObject.getComponent(ps),this.cam||(console.warn("CameraLayer requires a Camera component"),this.enabled=!1)}onAfterRender(){if(!this.cam)return;const t=this.scene.background;this.context.renderer.autoClearColor=!1,this.cam.cam instanceof Ts&&this.context.updateAspect(this.cam.cam),this.scene.background=null,this.context.renderer.render(this.scene,this.cam.cam),this.scene.background=t}}var Hs=Object.defineProperty,Xs=Object.getOwnPropertyDescriptor,xt=(o,t,e,i)=>{for(var s=i>1?void 0:i?Xs(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Hs(t,e,s),s};class it extends m{constructor(){super(...arguments),this.strength=10,this.maxInstances=10,this._instances=[],this._index=-1,this._onPointerDown=t=>{t.button===0&&this.throwBall(t.space.worldPosition,t.space.worldForward)}}start(){this.prefab&&y.setActive(this.prefab,!1),this.webXR??(this.webXR=y.findObjectOfType(ds))}onEnable(){this.context.input.addEventListener("pointerdown",this._onPointerDown)}onDisable(){this.context.input.removeEventListener("pointerdown",this._onPointerDown)}throwBall(t,e){var r,a;if(!this.prefab)return;if(this._instances.length<this.maxInstances){const p=new ms;p.position=t;const c=y.instantiate(this.prefab,p);if(!c)return;this._instances.push(c)}const i=++this._index,s=this._instances[i%this._instances.length];if(!s)return;ft(s,t),y.setActive(s,!0),(r=this.audioSource)==null||r.stop(),(a=this.audioSource)==null||a.play();const n=y.getComponent(s,V);n&&(e.multiplyScalar(this.strength),n.resetForcesAndTorques(),n.resetVelocities(),n==null||n.applyImpulse(e))}}xt([g(M)],it.prototype,"prefab",2);xt([g(Wt)],it.prototype,"audioSource",2);xt([g()],it.prototype,"strength",2);xt([g()],it.prototype,"maxInstances",2);var qs=Object.defineProperty,Ys=Object.getOwnPropertyDescriptor,$e=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ys(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&qs(t,e,s),s};class Qt extends m{constructor(){super(...arguments),this.applyOnStart=!0,this.randomMetallicRoughness=!0}start(){{const t=this.gameObject.getComponent(q);if(!t)return;for(let e=0;e<t.sharedMaterials.length;e++)t.sharedMaterials[e]=t.sharedMaterials[e].clone()}this.applyOnStart&&this.applyRandomColor()}applyRandomColor(){const t=this.gameObject.getComponent(q);if(!t){console.warn("Can not change color: No renderer on "+this.name);return}for(let e=0;e<t.sharedMaterials.length;e++){const i=t.sharedMaterials[e];i.color=new et(Math.random(),Math.random(),Math.random()),this.randomMetallicRoughness&&i instanceof Ee&&(i.metalness=Math.random(),i.roughness=Math.random()*Math.random()),i.needsUpdate=!0,us.markDirty(this.gameObject)}}}$e([g()],Qt.prototype,"applyOnStart",2);$e([g()],Qt.prototype,"randomMetallicRoughness",2);class Js extends m{constructor(){super(...arguments),this.renderer=null,this.collisionCount=0}start(){if(this.renderer=this.gameObject.getComponent(q),!!this.renderer){this._startColor||(this._startColor=[]);for(let t=0;t<this.renderer.sharedMaterials.length;t++)this.renderer.sharedMaterials[t]=this.renderer.sharedMaterials[t].clone(),this._startColor[t]=this.renderer.sharedMaterials[t].color.clone()}}onCollisionEnter(t){if(this.renderer){this.collisionCount+=1;for(let e=0;e<this.renderer.sharedMaterials.length;e++)this.renderer.sharedMaterials[e].color.setRGB(Math.random(),Math.random(),Math.random())}}onCollisionExit(t){if(!(!this.renderer||!this._startColor)&&(this.collisionCount-=1,this.collisionCount===0))for(let e=0;e<this.renderer.sharedMaterials.length;e++)this.renderer.sharedMaterials[e].color.copy(this._startColor[e])}}var Qs=Object.defineProperty,Ks=Object.getOwnPropertyDescriptor,Zs=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ks(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Qs(t,e,s),s};class Te extends m{update(){this.myMaterial&&(this.myMaterial._Speed*=1+this.context.time.deltaTime,this.myMaterial._Speed>1&&(this.myMaterial._Speed=5e-4),this.context.time.frame%30===0&&console.log(this.myMaterial._Speed))}}Zs([l(De)],Te.prototype,"myMaterial",2);var ks=Object.defineProperty,ti=Object.getOwnPropertyDescriptor,Ae=(o,t,e,i)=>{for(var s=i>1?void 0:i?ti(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ks(t,e,s),s};class Kt extends m{constructor(){super(...arguments),this.tempVec1=new _,this.tempVec2=new _}update(){if(!this.lodGroup||!this.text)return;const t=this.context.mainCamera;t.getWorldPosition(this.tempVec1),this.gameObject.getWorldPosition(this.tempVec2);const e=this.tempVec1.distanceTo(this.tempVec2)/t.zoom,i=this.lodGroup._lodsHandler;let s=null;i==null||i.forEach(n=>{var c,b;const r=n.levels[n.getCurrentLevel()],a=n.levels.at(n.getCurrentLevel()+1);let p=null;if(r.object instanceof As){const u=r.object.geometry.attributes,R=Math.floor(((c=u.position)==null?void 0:c.count)||0);p=`Triangles: ${Math.floor((((b=u.index)==null?void 0:b.count)||R)/3)}, Vertices: ${R}`}r.object.name.replace(/_/g,""),r.object.name.includes("Cull")||(s="",p&&(s+=`${p}
`),a==null||a.hysteresis,s+=`${r.distance.toFixed(1)} / ${e.toFixed(1)}`,a&&(s+=` / ${(a.distance-a.distance*a.hysteresis).toFixed(1)}`))}),s||(s="culled"),this.text.text=s}}Ae([l(fs)],Kt.prototype,"lodGroup",2);Ae([l(O)],Kt.prototype,"text",2);var ei=Object.defineProperty,si=Object.getOwnPropertyDescriptor,Zt=(o,t,e,i)=>{for(var s=i>1?void 0:i?si(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ei(t,e,s),s};class Ot extends m{constructor(){super(...arguments),this.apertureMultiplier=2,this.focalLength=.001,this.focusDistanceCutoff=25,this.volume=null,this.dofEffect=void 0}onEnable(){var t,e,i;this.volume=y.findObjectOfType(gs),this.dofEffect=(i=(e=(t=this.volume)==null?void 0:t.sharedProfile)==null?void 0:e.components)==null?void 0:i.find(s=>s.typeName==="DepthOfField"),this.orbit=y.findObjectOfType(vt)}onBeforeRender(){var e;if(!((e=this.orbit)!=null&&e.controls))return;const t=this.orbit.controls.target.distanceTo(Y(this.orbit.gameObject));if(this.dofEffect){this.dofEffect.focusDistance.value=t,this.dofEffect.focalLength.value=this.focalLength;let i=S.inverseLerp(0,this.focusDistanceCutoff,t);i=S.clamp01(i),this.dofEffect.aperture.value=S.lerp(this.apertureMultiplier,32,i);const s=this.focusDistanceCutoff;t>s&&this.dofEffect.active?this.dofEffect.active=!1:t<s&&!this.dofEffect.active&&(this.dofEffect.active=!0)}}}Zt([l()],Ot.prototype,"apertureMultiplier",2);Zt([l()],Ot.prototype,"focalLength",2);Zt([l()],Ot.prototype,"focusDistanceCutoff",2);class ii extends m{constructor(){super(...arguments),this._previousEnvironmentTexture=null}onEnable(){this._previousEnvironmentTexture=this.context.scene.environment,this.context.scene.environment=null}onDisable(){this.context.scene.environment=this._previousEnvironmentTexture}}var ni=Object.defineProperty,ri=Object.getOwnPropertyDescriptor,oi=(o,t,e,i)=>{for(var s=i>1?void 0:i?ri(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ni(t,e,s),s};const ai=G("sample_debugParticlesOnClick");class Me extends m{constructor(){super(...arguments),this.particleSystems=[]}update(){if(!this.context.isInVR&&this.context.input.getPointerClicked(0)){const t=this.context.physics.raycast();t.length>0&&this.spawnParticlesAt(t[0].point)}}onUpdateXR(t){t.xr.controllers.forEach(e=>{var i,s;if(((i=e.getButton("primary"))==null?void 0:i.isDown)===!0){const n=(s=this.context.physics.raycastFromRay(e.ray))==null?void 0:s.at(0);n&&this.spawnParticlesAt(n.point)}})}spawnParticlesAt(t){ft(this.gameObject,t),ai&&Gt.DrawWireSphere(t,.5,16711680,1);for(const e of this.particleSystems)e&&(y.setActive(e.gameObject,!0),e.play())}}oi([g(xe)],Me.prototype,"particleSystems",2);var li=Object.defineProperty,ci=Object.getOwnPropertyDescriptor,hi=(o,t,e,i)=>{for(var s=i>1?void 0:i?ci(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&li(t,e,s),s};class Le extends m{constructor(){super(...arguments),this.parameters=[]}awake(){var t=!1;this.parameters.forEach(e=>{G(e)||(bs(e,""),t=!0)}),t&&window.location.reload()}}hi([l()],Le.prototype,"parameters",2);var pi=Object.defineProperty,di=Object.getOwnPropertyDescriptor,Fe=(o,t,e,i)=>{for(var s=i>1?void 0:i?di(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&pi(t,e,s),s};class kt extends m{constructor(){super(...arguments),this.htmlSelector="button.some-button",this.onClick=new x,this.onClicked=()=>{this.onClick.invoke()}}onEnable(){this.element=document.querySelector(this.htmlSelector),this.element?this.element.addEventListener("click",this.onClicked):console.warn(`Could not find element with selector "${this.htmlSelector}"`)}onDisable(){this.element&&this.element.removeEventListener("click",this.onClicked)}}Fe([g()],kt.prototype,"htmlSelector",2);Fe([l(x)],kt.prototype,"onClick",2);var mi=Object.defineProperty,ui=Object.getOwnPropertyDescriptor,Be=(o,t,e,i)=>{for(var s=i>1?void 0:i?ui(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&mi(t,e,s),s};const Ve=class extends m{onEnable(){var o;if(!(!this.methods||!this.names)){console.log("HTMLMenu.onEnable"),this.wrapper=document.createElement("ul"),this.wrapper.classList.add("needle-menu");for(let t=0;t<this.methods.length;t++){const e=this.methods[t];let i="Button";t<((o=this.names)==null?void 0:o.length)&&(i=this.names[t]);const s=document.createElement("li"),n=document.createElement("button");n.innerHTML=i,n.onclick=()=>{e.invoke()},s.appendChild(n),this.wrapper.appendChild(s)}this.styleElement=document.createElement("style"),this.styleElement.innerHTML=Ve.style,document.head.appendChild(this.styleElement),this.context.domElement.appendChild(this.wrapper)}}onDisable(){this.wrapper&&(this.wrapper.remove(),this.wrapper=void 0),this.styleElement&&(this.styleElement.remove(),this.styleElement=void 0)}};let Pt=Ve;Pt.style=`
        .needle-menu {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            list-style-type: none;
            margin: 0;
            overflow: hidden;
            background-color: white;
            display: flex;
            padding: 5px;
            border-radius: 20px;
        }

        .needle-menu li button {
            padding: 5px;
            margin: 0 5px;
            background: none;
            outline: none;
            border: 0;
            cursor: pointer;
        }

        .needle-menu li button:hover {
            font-weight: bold;
        }
    `;Be([l(x)],Pt.prototype,"methods",2);Be([l()],Pt.prototype,"names",2);const be=new _,fi=new k,ye=new _;class gi extends M{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.parentNode.removeChild(e.element)})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}}const T=new qt,bi=new qt;class yi{constructor(t={}){const e=this;let i,s,n,r;const a={camera:{style:""},objects:new WeakMap},p=t.element!==void 0?t.element:document.createElement("div");p.style.overflow="hidden",this.domElement=p;const c=document.createElement("div");c.style.transformOrigin="0 0",c.style.pointerEvents="none",p.appendChild(c);const b=document.createElement("div");b.style.transformStyle="preserve-3d",c.appendChild(b),this.getSize=function(){return{width:i,height:s}},this.render=function(f,h){const I=h.projectionMatrix.elements[5]*r;h.view&&h.view.enabled?(c.style.transform=`translate( ${-h.view.offsetX*(i/h.view.width)}px, ${-h.view.offsetY*(s/h.view.height)}px )`,c.style.transform+=`scale( ${h.view.fullWidth/h.view.width}, ${h.view.fullHeight/h.view.height} )`):c.style.transform="",f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),h.parent===null&&h.matrixWorldAutoUpdate===!0&&h.updateMatrixWorld();let Q,D;h.isOrthographicCamera&&(Q=-(h.right+h.left)/2,D=(h.top+h.bottom)/2);const $=h.view&&h.view.enabled?h.view.height/h.view.fullHeight:1,K=h.isOrthographicCamera?`scale( ${$} )scale(`+I+")translate("+u(Q)+"px,"+u(D)+"px)"+R(h.matrixWorldInverse):`scale( ${$} )translateZ(`+I+"px)"+R(h.matrixWorldInverse),Z=(h.isPerspectiveCamera?"perspective("+I+"px) ":"")+K+"translate("+n+"px,"+r+"px)";a.camera.style!==Z&&(b.style.transform=Z,a.camera.style=Z),pt(f,f,h)},this.setSize=function(f,h){i=f,s=h,n=i/2,r=s/2,p.style.width=f+"px",p.style.height=h+"px",c.style.width=f+"px",c.style.height=h+"px",b.style.width=f+"px",b.style.height=h+"px"};function u(f){return Math.abs(f)<1e-10?0:f}function R(f){const h=f.elements;return"matrix3d("+u(h[0])+","+u(-h[1])+","+u(h[2])+","+u(h[3])+","+u(h[4])+","+u(-h[5])+","+u(h[6])+","+u(h[7])+","+u(h[8])+","+u(-h[9])+","+u(h[10])+","+u(h[11])+","+u(h[12])+","+u(-h[13])+","+u(h[14])+","+u(h[15])+")"}function W(f){const h=f.elements;return"translate(-50%,-50%)"+("matrix3d("+u(h[0])+","+u(h[1])+","+u(h[2])+","+u(h[3])+","+u(-h[4])+","+u(-h[5])+","+u(-h[6])+","+u(-h[7])+","+u(h[8])+","+u(h[9])+","+u(h[10])+","+u(h[11])+","+u(h[12])+","+u(h[13])+","+u(h[14])+","+u(h[15])+")")}function pt(f,h,I,Q){if(f.isCSS3DObject){const D=f.visible===!0&&f.layers.test(I.layers)===!0;if(f.element.style.display=D===!0?"":"none",D===!0){f.onBeforeRender(e,h,I);let $;f.isCSS3DSprite?(T.copy(I.matrixWorldInverse),T.transpose(),f.rotation2D!==0&&T.multiply(bi.makeRotationZ(f.rotation2D)),f.matrixWorld.decompose(be,fi,ye),T.setPosition(be),T.scale(ye),T.elements[3]=0,T.elements[7]=0,T.elements[11]=0,T.elements[15]=1,$=W(T)):$=W(f.matrixWorld);const K=f.element,Lt=a.objects.get(f);if(Lt===void 0||Lt.style!==$){K.style.transform=$;const Z={style:$};a.objects.set(f,Z)}K.parentNode!==b&&b.appendChild(K),f.onAfterRender(e,h,I)}}for(let D=0,$=f.children.length;D<$;D++)pt(f.children[D],h,I)}}}var vi=Object.defineProperty,wi=Object.getOwnPropertyDescriptor,St=(o,t,e,i)=>{for(var s=i>1?void 0:i?wi(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&vi(t,e,s),s};class nt extends m{constructor(){super(...arguments),this.url="https://www.youtube.com/embed/puWNRrG4MCg",this.pixelsPerUnit=500,this.borderRadius=50,this.animator=null,this.rotate90=new k().setFromAxisAngle(new _(0,1,0),Math.PI)}start(){const t=G("url");t&&(this.url=t);const e=document.createElement("div");e.innerHTML='<iframe width="1000" height="1000" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; xr-spatial-tracking; xr" allowfullscreen></iframe>',e.style.zIndex="10000",e.style.position="absolute",e.style.pointerEvents="initial";const i=e.querySelector("iframe");i.addEventListener("load",()=>{setTimeout(()=>{var p;console.log("Automatically opening iframe"),(p=this.animator)==null||p.SetBool("Open",!0)},1e3)}),i.src=this.url;let s=1e3;const n=Math.round(this.gameObject.scale.x*this.pixelsPerUnit),r=Math.round(this.gameObject.scale.y*this.pixelsPerUnit);s=Math.max(n,r),i.width=n+"px",i.height=r+"px",e.style.position="absolute",this.borderRadius>0&&(e.style.borderRadius=this.borderRadius+"px"),e.style.pointerEvents="initial",document.body.append(e),this.cssRenderer=new yi,this.cssRenderer.domElement.style.pointerEvents="none",this.cssRenderer.domElement.style.position="absolute",this.cssRenderer.domElement.style.top="0px",document.body.append(this.cssRenderer.domElement),this.cssScene=new Ms;const a=new gi(e);a.scale.setScalar(Math.max(this.gameObject.scale.x,this.gameObject.scale.y)/s),ft(a,Y(this.gameObject)),me(a,ue(this.gameObject)),a.quaternion.multiply(this.rotate90),this.cssScene.add(a),this.cssObj=a,this.context.post_render_callbacks.push(this.onPostRender.bind(this))}onPostRender(){if(!this.cssObj||!this.cssRenderer||!this.cssScene)return;ft(this.cssObj,Y(this.gameObject)),me(this.cssObj,ue(this.gameObject)),this.cssObj.quaternion.multiply(this.rotate90);const t=this.context.mainCamera,e=this.gameObject;var i=t.position.clone().sub(this.gameObject.position).normalize(),s=e.getWorldDirection(new _);const n=i.dot(s);this.cssObj.visible=n<.15;const r=this.cssRenderer.getSize();(r.width!==this.context.domWidth||r.height!==this.context.domHeight)&&this.cssRenderer.setSize(this.context.domWidth,this.context.domHeight),this.cssRenderer.render(this.cssScene,this.context.mainCamera)}}St([g()],nt.prototype,"url",2);St([g()],nt.prototype,"pixelsPerUnit",2);St([g()],nt.prototype,"borderRadius",2);St([g(H)],nt.prototype,"animator",2);class _i extends m{constructor(){super(...arguments),this._ui=null}awake(){const t=y.findObjectsOfType(ys),e=document.createElement("div");e.style.cssText=`
            position: absolute;
            top: 1em;
            left: 1em;
            line-height: 1.5em;
            display: block;
            width: 200px;
        `,this.context.domElement.appendChild(e),this._ui=e;const i=document.createElement("h2");i.style.cssText=`
            margin-bottom: .7em;
        `,i.innerText="Sample Images",e.appendChild(i);const s=document.createElement("p");s.innerHTML=`Download the image and print it or you can also open the image in your browser
        <br><strong>Then enter AR and scan it with your camera.</strong>
        <br>Visit our <a target="_blank" href="https://docs.needle.tools/image-tracking">ImageTracking documentation</a> for more information.
        `,s.style.userSelect="all",e.appendChild(s);for(const n of t)this.createDownloadImageUI(n,e)}update(){var t;this.context.isInAR?(t=this._ui)==null||t.remove():this._ui&&!this._ui.parentNode&&this.context.domElement.appendChild(this._ui)}createDownloadImageUI(t,e){if(t.trackedImages)for(const i of t.trackedImages){if(!i.image)continue;const s=document.createElement("a");s.href=i.image,e.appendChild(s);const n=document.createElement("img");n.src=i.image,n.style.cssText=`
                min-width: 180px;
                max-width: 220px;
                width: 15vw;
                height: auto;
                aspect-ratio: 1.3;
                object-fit: cover;
                background: rgba(0,0,0,0.5);
                border-radius: 10px;
                border: 2px solid rgba(255,255,255,1);
                box-shadow: 0 0 10px rgba(0,0,0,.2);
                margin-left: -.5em;
            `,s.appendChild(n)}}}var xi=Object.defineProperty,Oi=Object.getOwnPropertyDescriptor,Ct=(o,t,e,i)=>{for(var s=i>1?void 0:i?Oi(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&xi(t,e,s),s};class Vt extends m{onColorChanged(){typeof this.color=="number"&&(this.color=new et(this.color)),this.setColorToMaterials()}onPointerClick(t){const e=new et(Math.random(),Math.random(),Math.random());this.color=e}onEnable(){this.setColorToMaterials()}setColorToMaterials(){var e;const t=this.gameObject.getComponent(q);if(t)for(let i=0;i<t.sharedMaterials.length;i++){const s=(e=t.sharedMaterials[i])==null?void 0:e.clone();t.sharedMaterials[i]=s,s&&"color"in s&&(s.color=this.color)}else console.warn("No renderer found",this.gameObject)}}Ct([X(Vt.prototype.onColorChanged),l(et)],Vt.prototype,"color",2);class Ut extends m{constructor(){super(...arguments),this.myArray=[],this.updateArray=()=>{const t=new Date().toLocaleTimeString();console.log("> Update array",t),this.myArray.length>10&&(console.log("Clearing array because we have reached 10 entries"),this.myArray.length=0),this.myArray.push(t),this.myArray=this.myArray,j('<strong>> Sent</strong> "'+t+'", we now have '+this.myArray.length+" elements")}}awake(){j("Open this window in another browser tab/window to see the networking in action..."),this.context.connection.beginListen(Ht.JoinedRoom,async()=>{console.log("Will append a new value every 10 seconds"),setInterval(this.updateArray,1e4),await tt(100),this.updateArray()})}onArrayChanged(){console.log("< Received array",this.myArray[this.myArray.length-1],this.myArray),j('<strong>< Received</strong> "'+this.myArray[this.myArray.length-1]+'", we now have '+this.myArray.length+" elements")}}Ct([X(Ut.prototype.onArrayChanged)],Ut.prototype,"myArray",2);class Pi{constructor(){this.name="",this.age=0}}class bt extends m{constructor(){super(...arguments),this.myObject=new Pi,this._mockAge=0,this.updateObject=()=>{this.myObject.name=this.context.connection.connectionId,this._mockAge+=1,this.myObject.age=this._mockAge,this.myObject=this.myObject,console.log("> Updated",this.myObject),j('<strong>> Sent</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}awake(){j("Open this window in another browser tab/window to see the networking in action..."),this.context.connection.beginListen(Ht.JoinedRoom,async()=>{await tt(1),this.updateObject()})}onObjectChanged(){console.log("< Received object",this.myObject),j('<strong>< Received</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}Ct([X(bt.prototype.onObjectChanged)],bt.prototype,"myObject",2);Ct([X()],bt.prototype,"_mockAge",2);var Si=Object.defineProperty,Ci=Object.getOwnPropertyDescriptor,Ue=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ci(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Si(t,e,s),s};class te extends m{constructor(){super(...arguments),this.clampFrameRate=!0,this._clampFrameRate=!1,this.maxFrameRate=72,this._maxFrameRate=-1024}update(){if(this._clampFrameRate!==this.clampFrameRate||this._maxFrameRate!==this.maxFrameRate){const t=this.clampFrameRate?this.maxFrameRate:void 0;this.context.targetFrameRate=t,this._clampFrameRate=this.clampFrameRate,this._maxFrameRate=this.maxFrameRate}}setTarget(t){this.maxFrameRate=t,this.clampFrameRate=!0}setClamping(t){this.clampFrameRate=t}}Ue([l()],te.prototype,"clampFrameRate",2);Ue([l()],te.prototype,"maxFrameRate",2);var ji=Object.defineProperty,Ii=Object.getOwnPropertyDescriptor,N=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ii(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ji(t,e,s),s};class rt extends m{constructor(){super(...arguments),this.logEvents=!1}onCollisionEnter(t){var e;this.logEvents&&console.log("ENTER",t),(e=this.onEnter)==null||e.invoke(t)}onCollisionStay(t){var e;this.logEvents&&console.log("STAY",t),(e=this.onStay)==null||e.invoke(t)}onCollisionExit(t){var e;this.logEvents&&console.log("EXIT",t),(e=this.onExit)==null||e.invoke(t)}}N([g(x)],rt.prototype,"onEnter",2);N([g(x)],rt.prototype,"onStay",2);N([g(x)],rt.prototype,"onExit",2);N([g()],rt.prototype,"logEvents",2);class ot extends m{onTriggerEnter(t){var e,i;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(i=this.onEnter)==null||i.invoke()}onTriggerStay(t){var e,i;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(i=this.onStay)==null||i.invoke()}onTriggerExit(t){var e,i;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(i=this.onExit)==null||i.invoke()}}N([g(y)],ot.prototype,"triggerObjects",2);N([g(x)],ot.prototype,"onEnter",2);N([g(x)],ot.prototype,"onStay",2);N([g(x)],ot.prototype,"onExit",2);var Ei=Object.defineProperty,Di=Object.getOwnPropertyDescriptor,Ri=(o,t,e,i)=>{for(var s=i>1?void 0:i?Di(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Ei(t,e,s),s};class Ne extends m{constructor(){super(...arguments),this._lastTriggerTime=0}onTriggerEnter(t){this.context.time.time-this._lastTriggerTime<.3||(this._lastTriggerTime=this.context.time.time,this.animation&&this.animation.play(0,{loop:!1}))}onTriggerExit(){}}Ri([g(Xt)],Ne.prototype,"animation",2);var $i=Object.defineProperty,Ti=Object.getOwnPropertyDescriptor,Ai=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ti(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&$i(t,e,s),s};class ze extends m{onTriggerEnter(){var t,e;(t=this.animation)!=null&&t.isPlaying||(e=this.animation)==null||e.play(0,{loop:!1})}}Ai([g(Xt)],ze.prototype,"animation",2);var Mi=Object.defineProperty,Li=Object.getOwnPropertyDescriptor,Fi=(o,t,e,i)=>{for(var s=i>1?void 0:i?Li(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Mi(t,e,s),s};class We extends m{onCollisionEnter(){var t,e;(t=this.audioSource)==null||t.stop(),(e=this.audioSource)==null||e.play()}}Fi([g(Wt)],We.prototype,"audioSource",2);var Bi=Object.defineProperty,Vi=Object.getOwnPropertyDescriptor,Ge=(o,t,e,i)=>{for(var s=i>1?void 0:i?Vi(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Bi(t,e,s),s};class ee extends m{constructor(){super(...arguments),this.referenceSize=512,this.updateSize=()=>{if(this.content){if(this.referenceSize<=0)return console.error("ResponsiveContent: Base width must be greater than 0.");const t=this.context.domWidth/this.referenceSize;this.content.scale.set(t,t,t)}else gt()&&console.warn("ResponsiveContent: No content object set.")}}onEnable(){window.addEventListener("resize",this.updateSize),this.updateSize()}onDisable(){window.removeEventListener("resize",this.updateSize)}}Ge([l(M)],ee.prototype,"content",2);Ge([l()],ee.prototype,"referenceSize",2);var Ui=Object.defineProperty,Ni=Object.getOwnPropertyDescriptor,se=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ni(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Ui(t,e,s),s};class He extends m{async sceneOpened(){var t;(t=this.animator)==null||t.setBool("SceneOpen",!0),this._htmlElement=this._getHtmlElement(),this.context.domElement.appendChild(this._htmlElement)}async sceneClosing(){var t,e;await tt(1e3),(t=this.animator)==null||t.setBool("SceneOpen",!1),await tt(1e3),(e=this._htmlElement)==null||e.remove()}_getHtmlElement(){if(!this._htmlElement){this._htmlElement=document.createElement("div"),this._htmlElement.style.cssText=`
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                // backdrop-filter: blur(10px);
            `;const t=document.createElement("img");t.src="https://engine.needle.tools/branding/needle-logo.png",this._htmlElement.appendChild(t)}return this._htmlElement}}se([l(H)],He.prototype,"animator",2);class ie extends m{sceneOpened(){var t;return gt()&&console.log("Scene opened",this.name),(t=this.opened)==null||t.invoke(),Promise.resolve()}sceneClosing(){var t;return gt()&&console.log("Scene closing",this.name),(t=this.closing)==null||t.invoke(),Promise.resolve()}}se([l(x)],ie.prototype,"opened",2);se([l(x)],ie.prototype,"closing",2);class zi extends m{next(){var t;this.switcher??(this.switcher=this.get()),console.log(this.switcher),(t=this.switcher)==null||t.selectNext()}previous(){var t;this.switcher??(this.switcher=this.get()),(t=this.switcher)==null||t.selectPrev()}get(){return y.findObjectOfType(vs)}}var Wi=Object.defineProperty,Gi=Object.getOwnPropertyDescriptor,Hi=(o,t,e,i)=>{for(var s=i>1?void 0:i?Gi(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Wi(t,e,s),s};class Xe extends m{constructor(){super(...arguments),this.text=""}start(){j(this.text)}}Hi([l()],Xe.prototype,"text",2);var Xi=Object.defineProperty,qi=Object.getOwnPropertyDescriptor,Yi=(o,t,e,i)=>{for(var s=i>1?void 0:i?qi(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Xi(t,e,s),s};const Ji=G("testleaderboard");class Nt extends m{constructor(){super(...arguments),this._ready=!1}get ready(){return this._ready}onEnable(){this.context.connection.beginListen(Ht.JoinedRoom,async()=>{await tt(100),this.context.connection.tryGetState(this.guid)||(this.data={scores:[]}),this._ready=!0}),Ji?(console.log("Enabled test leaderboard, adding random scores"),setInterval(()=>{this.insertScore("Player",Math.floor(Math.random()*1e3))},2e3)):gt()&&j("You can add ?testleaderboard to the url to test the leaderboard")}insertScore(t,e){if(!this._ready){console.warn("Cannot insert score, data not received yet");return}const i=10,s=this.data.scores;for(;s.length>=i;){this.sortScores();const n=s.pop();if(n.score>e){console.log(`Score ${e} is lower than ${n==null?void 0:n.score} (lowest score), ignoring`),s.push(n);return}}console.log("Inserting score",t,e),s.push({name:t,score:e}),this.sortScores(),this.data=this.data}sortScores(){this.data.scores.sort((t,e)=>e.score-t.score)}onDataChanged(t){if(console.warn("Data changed!",t,this.data.scores),this.data.scores.length>0){const e=this.data.scores[0];j("HIGHSCORE - "+e.name+": "+e.score)}this.dispatchEvent(new CustomEvent("changed",{detail:this.data}))}}Yi([X(Nt.prototype.onDataChanged)],Nt.prototype,"data",2);var Qi=Object.defineProperty,Ki=Object.getOwnPropertyDescriptor,Zi=(o,t,e,i)=>{for(var s=i>1?void 0:i?Ki(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Qi(t,e,s),s};class qe extends m{start(){this.updateStartPosition()}updateStartPosition(){this.startPosition=this.gameObject.position.clone()}resetToStart(){if(!this.startPosition)return;const t=y.getComponent(this.gameObject,V);t==null||t.teleport(this.startPosition)}}class Ye extends qe{start(){super.start(),this.worldCollider||console.warn("Missing collider to reset",this)}onTriggerExit(t){t===this.worldCollider&&this.resetToStart()}}Zi([g(wt)],Ye.prototype,"worldCollider",2);var ki=Object.defineProperty,tn=Object.getOwnPropertyDescriptor,en=(o,t,e,i)=>{for(var s=i>1?void 0:i?tn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ki(t,e,s),s};class Je extends m{constructor(){super(...arguments),this.roomId="",this.playerCount=0}update(){const t=this.context.connection;let e=!1;t.currentRoomName&&t.currentRoomName!==this.roomId&&(this.roomId=t.currentRoomName,e=!0),t.usersInRoom().length!==this.playerCount&&(this.playerCount=t.usersInRoom().length,e=!0),e&&this.connectionLabel&&(this.connectionLabel.text=`Room: ${this.roomId}
Users: ${this.playerCount}
Your id: ${t.connectionId}`)}}en([l(O)],Je.prototype,"connectionLabel",2);var sn=Object.defineProperty,nn=Object.getOwnPropertyDescriptor,rn=(o,t,e,i)=>{for(var s=i>1?void 0:i?nn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&sn(t,e,s),s};class Qe extends m{constructor(){super(...arguments),this.interval=1e3,this.max=100,this.spawned=0}awake(){if(!this.object){console.warn("TimedSpawn: no object to spawn"),j("TimedSpawn: no object to spawn",Oe.Warn);return}y.setActive(this.object,!1),this.startCoroutine(this.spawn())}*spawn(){if(this.object)for(;this.spawned<this.max;){const t=y.instantiate(this.object);y.setActive(t,!0),this.spawned+=1,yield ws(this.interval/1e3)}}}rn([g(y)],Qe.prototype,"object",2);class on extends m{async awake(){const t=document.createElement("video");t.style.cssText=`
            position: fixed;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
        `,this.context.domElement.shadowRoot.appendChild(t);const e=await navigator.mediaDevices.getUserMedia({video:!0});if(!e)return;t.srcObject=e,t.play();const i=this.context.mainCameraComponent;i&&(i.clearFlags=_s.SolidColor,i.backgroundColor=new xs(125,125,125,0))}}var an=Object.defineProperty,ln=Object.getOwnPropertyDescriptor,jt=(o,t,e,i)=>{for(var s=i>1?void 0:i?ln(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&an(t,e,s),s};class at extends m{constructor(){super(...arguments),this.interval=3,this.resetPosition=!0,this.resetRotation=!1,this.resetVelocity=!1}start(){const t=this.gameObject.position.clone(),e=this.gameObject.rotation.clone(),i=this.gameObject.getComponent(V),s=this.context.time.frame;setInterval(()=>{this.resetPosition&&this.gameObject.position.copy(t),this.resetRotation&&this.gameObject.rotation.copy(e),i&&this.resetVelocity&&this.context.time.frame!==s&&i.resetVelocities()},this.interval*1e3)}}jt([l()],at.prototype,"interval",2);jt([l()],at.prototype,"resetPosition",2);jt([l()],at.prototype,"resetRotation",2);jt([l()],at.prototype,"resetVelocity",2);class cn extends m{constructor(){super(...arguments),this.toggleRendererOnly=!1}start(){setInterval(()=>{if(j('This is a sample for showing how to <a href="https://engine.needle.tools/docs/scripting.html#component-architecture" target="_blank">toggle visibility of a GameObject</a>'),this.toggleRendererOnly){const t=this.gameObject.getComponent(q);t&&(t.enabled=!t.enabled)}else this.gameObject.visible=!this.gameObject.visible},1e3)}}var hn=Object.defineProperty,pn=Object.getOwnPropertyDescriptor,dn=(o,t,e,i)=>{for(var s=i>1?void 0:i?pn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&hn(t,e,s),s};class Ke extends m{awake(){this.material&&(this.material.wireframe=!0)}}dn([l(De)],Ke.prototype,"material",2);var mn=Object.defineProperty,un=Object.getOwnPropertyDescriptor,Ze=(o,t,e,i)=>{for(var s=i>1?void 0:i?un(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&mn(t,e,s),s};class ne extends m{constructor(){super(...arguments),this.onSessionStart=new x,this.onSessionEnd=new x}onEnterXR(t){this.onWebXRStarted()}onExitXR(t){this.onWebXREnded()}onWebXRStarted(){fe(this.context.scene,!1),this.onSessionStart.invoke()}onWebXREnded(){fe(this.context.scene,!1),this.onSessionEnd.invoke()}}Ze([l(x)],ne.prototype,"onSessionStart",2);Ze([l(x)],ne.prototype,"onSessionEnd",2);class ke extends m{constructor(){super(...arguments),this.destroyTarget=!1,this._startTime=0}awake(){if(this._rigidbody=this.gameObject.getComponentInParent(V)||void 0,this._rigidbody){const t=this.gameObject.getComponentsInChildren(wt);for(const e of t){const i=y.addComponent(e.gameObject,fn);i.rigidBody=this._rigidbody,i.arrow=this,i.destroyTarget=this.destroyTarget}}this._startTime=this.context.time.time}onBeforeRender(){if(this.context.time.time-this._startTime>5){this.gameObject.destroy();return}if(this._rigidbody){const t=this._rigidbody.getVelocity();if(t.lengthSq()>0){const e=E().set(t.x,t.y,t.z).normalize(),i=Pe();i.setFromUnitVectors(E(0,0,1),e),this.gameObject.quaternion.copy(i)}}}}class fn extends m{constructor(){super(...arguments),this.destroyTarget=!1}onCollisionEnter(t){if(this.arrow)if(this.destroyTarget)t.gameObject.destroy(),this.arrow.gameObject.destroy();else{t.gameObject.attach(this.arrow.gameObject),t.rigidBody instanceof V&&t.rigidBody.applyImpulse(t.gameObject.position.clone().multiply(this.rigidBody.getVelocity()),!0);const e=this.rigidBody.gameObject.getComponentsInChildren(wt);for(const i of e)i.destroy();this.rigidBody.destroy(),this.arrow.destroy()}}}var gn=Object.defineProperty,bn=Object.getOwnPropertyDescriptor,C=(o,t,e,i)=>{for(var s=i>1?void 0:i?bn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&gn(t,e,s),s};const yn=G("debugarrow");class P extends m{constructor(){super(...arguments),this.power=1.5,this.drawMaxPhysicalDistance=.47269,this.drawMinPhysicalDistance=.1132593,this.desktopIdleDrawAmount=.25,this.interactionPixelOrigin=new F(.5,.65),this.interactionPixelTreshold=85,this.drawMaxPixelDistance=100,this._isAiming=!1,this._aimingPointerStartPos=new F(0,0),this._bowController=void 0,this._stringController=void 0,this.onDown=t=>{var e;if(t.origin instanceof ge){if(t.button===0){this._isAiming=!0,this._bowController===void 0?this._bowController=t.origin.index:this._stringController===void 0&&(this._stringController=t.origin.index);const i=(e=this.bowObject)==null?void 0:e.getComponentInParent(Ss);i&&(i.side=this._bowController)}}else t.button===0&&(this.getPointerDinstanceTo(this._aimingPointerStartPos,t.pointerId),this._isAiming=!0,this._aimingPointerId=t.pointerId)},this.onRelease=t=>{var e;if(t.button===0&&this._isAiming){if(this._isAiming=!1,this._aimingPointerId=void 0,t.origin instanceof ge){const i=t.origin;if(i.index===this._stringController&&this._bowController!==void 0){const s=(e=_e.active)==null?void 0:e.getController(this._bowController);if(i&&s){const n=i.gripWorldPosition;if(n){const r=s.gripWorldPosition.clone().sub(n);let a=s.object.worldPosition.distanceTo(i.object.worldPosition);a-=this.drawMinPhysicalDistance;const p=S.clamp01(a/this.drawMaxPhysicalDistance);r.normalize().multiplyScalar(p*this.power),this.shoot(n,r),yn&&Gt.DrawArrow(n,r.clone().add(n),16776960,1)}}}i.index===this._bowController&&(this._bowController=void 0),i.index===this._stringController&&(this._stringController=void 0)}else if(this.arrowSpawnSpot){const i=this.arrowSpawnSpot.getWorldPosition(E()),s=this.gameObject.getWorldDirection(E()),n=this.getPointerDinstanceTo(this._aimingPointerStartPos,t.pointerId),r=S.clamp01(n/this.drawMaxPixelDistance)*this.power;s.multiplyScalar(r),n>this.interactionPixelTreshold&&this.shoot(i,s)}}},this.shotStamp=Number.MIN_SAFE_INTEGER,this.fakeArrowRespawnDuration=.3,this._initRot=new k,this._tempLookMatrix=new qt,this._tempLookRot=new k,this._rotate90=new k().setFromAxisAngle(new _(0,0,1),Math.PI/2),this.tempDir=new F,this.tempUpRef=new F}awake(){var t;(t=this.arrowPrefab)!=null&&t.asset&&(this.arrowPrefab.asset.visible=!1),this.bowObject&&this._initRot.copy(this.bowObject.quaternion),this.nonMountedParent=this.gameObject.parent,this.mount()}onEnable(){var t;(t=this.arrowPrefab)==null||t.loadAssetAsync(),this._isAiming=!1,this.context.input.addEventListener("pointerdown",this.onDown),this.context.input.addEventListener("pointerup",this.onRelease),this.setupPreDraw()}onDisable(){this._isAiming=!1,this.context.input.removeEventListener("pointerdown",this.onDown),this.context.input.removeEventListener("pointerup",this.onRelease)}getPointerDinstanceTo(t,e){const i=this.context.input.getPointerPosition(e);return t.distanceTo(i)}async setupPreDraw(){var e,i;if(!this.arrowPrefab||!this.arrowSpawnSpot||this.fakeArrow)return;const t=await this.arrowPrefab.instantiate({parent:this.arrowSpawnSpot});t&&(t.visible=!0,t.worldScale=E(1,1,1),this.fakeArrow=t,(e=t.getComponent(ke))==null||e.destroy(),(i=t.getComponent(V))==null||i.destroy(),t.getComponentsInChildren(wt).forEach(s=>s.destroy()))}async shoot(t,e){var c,b;if(!this.arrowPrefab)return;this.shotStamp=this.context.time.time;const i=t.clone(),s=i.clone().add(e),n=Math.pow(e.length()+.5,2),r=e.clone().normalize(),a=await this.arrowPrefab.instantiate({parent:this.context.scene});if(!a)return;a.worldPosition=i,a.lookAt(s),a.visible=!0;const p=a.getComponent(V);p&&(p.isKinematic=!1,p.autoMass=!1,p.mass=.05,(c=this.sound)==null||c.stop(),(b=this.sound)==null||b.play(),await Se(1),p.applyImpulse(r.multiplyScalar(n),!0))}mount(){this.cameraParent&&(this.gameObject.parent=this.cameraParent,this.gameObject.position.set(0,0,0),this.gameObject.quaternion.set(0,0,0,1))}unmount(){this.gameObject.parent=this.nonMountedParent}get _hasControllers(){var t;return(((t=this.context.xr)==null?void 0:t.controllers.length)??0)>0}onEnterXR(t){(t.xr.isVR||t.xr.isPassThrough)&&this.unmount()}onLeaveXR(t){this.mount()}onBeforeRender(){if(!this.animationComponent||!this.bowObject)return;if(!this._mixer){this._mixer=new Ls(this.bowObject);const n=this.animationComponent.animations.at(0);n&&(this._animation=this._mixer.clipAction(n))}const t=.1;let e=0;if(this._hasControllers){if(!this._isAiming)e=0;else if(this.context.xr&&this.context.xr.controllers.length>1&&this._bowController!==void 0&&this._stringController!==void 0){const n=this.context.xr.controllers[this._stringController],r=this.context.xr.controllers[this._bowController];if(!n||!r)return;let a=E(0,1,0);!r.hand&&r.targetRayMode==="tracked-pointer"&&a.applyQuaternion(this._rotate90),a.applyQuaternion(r.gripWorldQuaternion).normalize(),this._tempLookMatrix.lookAt(n.gripWorldPosition,r.gripWorldPosition,a),this._tempLookRot.setFromRotationMatrix(this._tempLookMatrix),this.bowObject.worldQuaternion=this._tempLookRot;let p=n.object.worldPosition.distanceTo(r.object.worldPosition);p-=this.drawMinPhysicalDistance,e=S.clamp01(p/this.drawMaxPhysicalDistance)}}else{const n=this.interactionPixelOrigin;if(this._aimingPointerStartPos.set(this.context.domWidth*n.x,this.context.domHeight*n.y),!this._isAiming)e=this.desktopIdleDrawAmount;else{const r=this.context.input;if(this._aimingPointerId!=null){const a=this._aimingPointerStartPos,p=r.getPointerPosition(this._aimingPointerId),c=this.tempDir.copy(p).sub(a),u=c.length(),R=E();R.x=c.x,R.z=c.y,R.normalize();const W=this.gameObject.getWorldDirection(E());W.y=0,W.normalize();const pt=R.dot(W),f=u>this.interactionPixelTreshold;(pt>0||f)&&(e=S.clamp01(u/this.drawMaxPixelDistance)),this.tempUpRef.set(1,0);const I=this.tempUpRef.dot(c)>0?-1:1;this.tempUpRef.set(0,1);const Q=this.tempUpRef.angleTo(c)*I;if(f){const D=Pe().setFromAxisAngle(E().set(1,0,0),Q);this.gameObject.quaternion.slerp(D,this.context.time.deltaTime/.05)}}}}this.drawProgression&&(e=this.drawProgression.evaluate(e)),this._animation.timeScale=0;const i=S.lerp(this._animation.time,e,this.context.time.deltaTime/t),s=this._animation.time;if(this._animation.time=i,Math.abs(i-s)>Number.EPSILON&&(this._animation.setEffectiveWeight(1),this._animation.play()),this._mixer.update(this.context.time.deltaTime),this.fakeArrow){let n=(this.context.time.time-this.shotStamp)/this.fakeArrowRespawnDuration;n=this.easeInOutSine(S.clamp01(n)),this.fakeArrow.worldScale=E(1,1,1).multiplyScalar(n)}}easeInOutSine(t){return S.clamp01(-.5*(Math.cos(Math.PI*t)-1))}}C([l()],P.prototype,"power",2);C([l()],P.prototype,"drawMaxPhysicalDistance",2);C([l()],P.prototype,"drawMinPhysicalDistance",2);C([l(Os)],P.prototype,"drawProgression",2);C([l(M)],P.prototype,"cameraParent",2);C([l()],P.prototype,"desktopIdleDrawAmount",2);C([l(F)],P.prototype,"interactionPixelOrigin",2);C([l()],P.prototype,"interactionPixelTreshold",2);C([l()],P.prototype,"drawMaxPixelDistance",2);C([l(M)],P.prototype,"bowObject",2);C([l(Xt)],P.prototype,"animationComponent",2);C([l(Ps)],P.prototype,"arrowPrefab",2);C([l(M)],P.prototype,"arrowSpawnSpot",2);C([l(Wt)],P.prototype,"sound",2);C([l()],P.prototype,"fakeArrowRespawnDuration",2);var vn=Object.defineProperty,wn=Object.getOwnPropertyDescriptor,_n=(o,t,e,i)=>{for(var s=i>1?void 0:i?wn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&vn(t,e,s),s};class ts extends m{start(){this._meshRenderer=this.gameObject.getComponentInChildren(Cs)}onDestroy(){if(this.particleSystem){if(this.particleSystem.shape.shapeType===Ft.MeshRenderer&&this._meshRenderer&&!Ce(this._meshRenderer.gameObject)){this.particleSystem.shape.shapeType=Ft.MeshRenderer,this.particleSystem.shape.setMesh(this._meshRenderer),this.particleSystem.play();return}this.particleSystem.shape.shapeType=Ft.Sphere,this.particleSystem.worldPosition=this.gameObject.worldPosition,this.particleSystem.play()}}}_n([l(xe)],ts.prototype,"particleSystem",2);var xn=Object.defineProperty,On=Object.getOwnPropertyDescriptor,Pn=(o,t,e,i)=>{for(var s=i>1?void 0:i?On(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&xn(t,e,s),s};class es extends m{constructor(){super(...arguments),this._instances=new Array}awake(){var t,e;if(!((t=this.prefabs)!=null&&t.length)||((e=this.prefabs)==null?void 0:e.length)===0){console.warn("BowTargetSpawner start: no prefab set"),this.enabled=!1;return}this.prefabs.forEach(i=>i.visible=!1)}update(){var e;if(!((e=this.prefabs)!=null&&e.length))return;const t=E();for(let i=this._instances.length-1;i>=0;i--){const s=this._instances[i];Ce(s.instance)?this._instances.splice(i,1):(t.setScalar(s.scale),s.instance.scale.lerp(t,this.context.time.deltaTime))}if(this.context.time.frame%20===0&&Math.random()>.5){const i=this.worldPosition;i.x+=Math.random()*12-6,i.y+=Math.random()*3,i.z+=Math.random()*6;const s=Math.random()*3+.5,n=this.prefabs[Math.floor(Math.random()*this.prefabs.length)],r=js(n,{parent:this.scene,position:i.clone(),scale:new _(.01,.01,.01),keepWorldPosition:!0});r.visible=!0,this._instances.push({instance:r,scale:s}),setTimeout(()=>{r.destroy()},7e3),Se(1).then(()=>{const a=r.getComponentInChildren(V);a&&(a.gravityScale=.2+Math.random()*.3,a.mass=2,a.autoMass=!1),a==null||a.setAngularVelocity(S.random(-2,2),S.random(-2,2),S.random(-2,2)),a==null||a.applyImpulse({x:0,y:5+Math.random()*12,z:0})})}}}Pn([l(M)],es.prototype,"prefabs",2);var Sn=Object.defineProperty,Cn=Object.getOwnPropertyDescriptor,jn=(o,t,e,i)=>{for(var s=i>1?void 0:i?Cn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Sn(t,e,s),s};class re extends m{constructor(){super(...arguments),this.displayName=""}}jn([l()],re.prototype,"displayName",2);var In=Object.defineProperty,En=Object.getOwnPropertyDescriptor,oe=(o,t,e,i)=>{for(var s=i>1?void 0:i?En(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&In(t,e,s),s};class It extends m{constructor(){super(...arguments),this.objects=[],this.hideContentOnStart=!0,this.index=-1}awake(){this.hideContentOnStart||(this.index=0),this.apply()}next(){this.index++,this.index>=this.objects.length&&(this.index=0),this.apply()}previous(){this.index--,this.index<0&&(this.index=this.objects.length-1),this.apply()}apply(){for(let t=0;t<this.objects.length;t++)this.objects[t].visible=t===this.index;if(this.lable){const t=this.objects[this.index];if(t){const e=y.getComponent(t,re);this.lable.text=(e==null?void 0:e.displayName)??t.name}}}select(t){this.index=t,this.index=S.clamp(this.index,0,this.objects.length-1),this.apply()}}oe([l(M)],It.prototype,"objects",2);oe([l()],It.prototype,"hideContentOnStart",2);oe([l(O)],It.prototype,"lable",2);d.add("AspectRatioFitterUI",Yt);d.add("CameraGoal",_t);d.add("CameraLayer",Gs);d.add("Cannon",it);d.add("RandomColor",Qt);d.add("ChangeColorOnCollision",Js);d.add("IncreaseShaderSpeedOverTime",Te);d.add("DebugLOD",Kt);d.add("DepthOfFieldController",Ot);d.add("DisableEnvironmentLight",ii);d.add("EmitParticlesOnClick",Me);d.add("EnforceParameters",Le);d.add("HTMLButtonClick",kt);d.add("HTMLMenu",Pt);d.add("IFrameContent",nt);d.add("ImageTrackingDownloadUI",_i);d.add("Networking_ClickToChangeColor",Vt);d.add("Networking_StringArray",Ut);d.add("Networking_Object",bt);d.add("PerformanceSettings",te);d.add("PhysicsCollision",rt);d.add("PhysicsTrigger",ot);d.add("PlayAnimationOnCollision",Ne);d.add("PlayAnimationOnTrigger",ze);d.add("PlayAudioOnCollision",We);d.add("ResponsiveContent",ee);d.add("LoadingSceneRoot",He);d.add("SceneLoadingEvents",ie);d.add("SceneSwitcherControls",zi);d.add("ShowBalloonMessage",Xe);d.add("SimpleLeaderboard",Nt);d.add("StartPosition",qe);d.add("AutoReset",Ye);d.add("SyncedRoomUI",Je);d.add("TimedSpawn",Qe);d.add("VideoBackground",on);d.add("ResetPositionOnInterval",at);d.add("ToggleVisibility",cn);d.add("WireframeMaterial",Ke);d.add("XRLifecycleEvents",ne);d.add("Arrow",ke);d.add("ArrowShooting",P);d.add("BowArrowTarget",ts);d.add("BowTargetSpawner",es);d.add("VariantInfo",re);d.add("VariantSwitcher",It);var Dn=Object.defineProperty,Rn=Object.getOwnPropertyDescriptor,$n=(o,t,e,i)=>{for(var s=i>1?void 0:i?Rn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Dn(t,e,s),s};const dt=G("debugsyncanimator"),ss=class extends m{constructor(){super(...arguments),this.syncedAnimGuid=null,this.localParameters=[],this.currentController=null,this.isSyncAnim=!0,this.tempValues=[],this.modelRecieved=o=>{var i,s;if(!this.animator)return;dt&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator incoming message`);for(let n=0;n<o.values.length;n++){const r=this.localParameters[n],a=o.values[n];var t=null;switch(r.type){case w.Trigger:case w.Bool:t=a==1;break;case w.Float:case w.Int:t=a||0;break}t!==r.value&&(dt&&console.log(`Remote parameter: ${r.name} | ${r.value} --> ${t}`),r.value=t)}const e=o.state;if(e!==0){const n=(i=this.animator.runtimeAnimatorController)==null?void 0:i.findState(e);this.remoteState=n,dt&&console.log(`${this.context.time.time.toFixed(2)} Remote state: ${(s=this.currentState)==null?void 0:s.name} --> ${n==null?void 0:n.name}`)}}}set SyncedAnimGuid(o){this.unregisterNetMessage(),this.syncedAnimGuid=o,this.registerNetMessage()}get SyncedAnimGuid(){return this.syncedAnimGuid}get currentState(){var o,t;return(t=(o=this.animator)==null?void 0:o.runtimeAnimatorController)==null?void 0:t.activeState}start(){this.SyncedAnimGuid??(this.SyncedAnimGuid=`${this.guid}`),this.enabled=this.localParameters!==void 0,this.enabled||console.warn("SyncAnimator has to be on an object with an Animator componenet")}onControllerChanged(){var o,t,e;this.animator=this.gameObject.getComponent(H),this.currentController=(o=this.animator)==null?void 0:o.runtimeAnimatorController,this.localParameters=(e=(t=this.currentController)==null?void 0:t.model)==null?void 0:e.parameters}registerNetMessage(){this.context.connection.beginListen(this.syncedAnimGuid,this.modelRecieved)}unregisterNetMessage(){this.context.connection.stopListen(this.syncedAnimGuid,this.modelRecieved)}onDestroy(){this.unregisterNetMessage()}onBeforeRender(){if(this.isSyncAnim!==void 0)return;const o=this.gameObject.getComponent(ss);!o||!o.enabled||(o.syncedAnimatorUpdate(),o.applyRemoteState(),o.dispatchChanges())}syncedAnimatorUpdate(){var o;this.currentController!==((o=this.animator)==null?void 0:o.runtimeAnimatorController)&&this.onControllerChanged()}applyRemoteState(){var o;this.remoteState&&this.remoteState!==this.currentState&&((o=this.animator.runtimeAnimatorController)==null||o.play(this.remoteState.hash),this.remoteState=null)}dispatchChanges(){!this.animator.parametersAreDirty&&!this.animator.isDirty||this.createAndSndModel(this.localParameters,this.animator.isDirty?this.currentState:void 0)}createAndSndModel(o,t){const e=this.context.connection;if(!e.isInRoom)return;this.tempValues.length=o.length;for(let n=0;n<o.length;n++){const r=o[n];var i=0;switch(r.type){case w.Trigger:case w.Bool:i=r.value?1:0;break;case w.Float:case w.Int:i=r.value;break}this.tempValues[n]=i}const s={guid:this.syncedAnimGuid,values:this.tempValues,state:(t==null?void 0:t.hash)||0};dt&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator outgoing message`),e.send(this.guid,s)}};let Et=ss;$n([Is(H)],Et.prototype,"onBeforeRender",1);var Tn=Object.defineProperty,An=Object.getOwnPropertyDescriptor,z=(o,t,e,i)=>{for(var s=i>1?void 0:i?An(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Tn(t,e,s),s};class J extends m{constructor(){super(...arguments),this.animParam="",this.animParamToDisable=""}awake(){var e,i,s;const t=(s=(i=(e=this.animator)==null?void 0:e.runtimeAnimatorController)==null?void 0:i.model)==null?void 0:s.parameters;t&&(this.parameter=t.find(n=>n.name===this.animParam))}onPointerClick(t){var s,n,r;if(!this.animator||!this.syncAnimator||!this.parameter)return;const e=this.parameter.type;if(e==w.Float){var i=this.animator.getFloat(this.animParam)+.6;i>=1.7&&(i=0),this.animator.setFloat(this.animParam,i)}if((e==w.Bool||e==w.Trigger)&&this.animator.setBool(this.animParam,!this.parameter.value),this.animParamToDisable!=""){const a=(r=(n=(s=this.animator)==null?void 0:s.runtimeAnimatorController)==null?void 0:n.model)==null?void 0:r.parameters;if(!a)return;const p=a.find(c=>c.name===this.animParamToDisable);if(p){const c=p.type;c==w.Float||c==w.Int?this.animator.setFloat(this.animParamToDisable,0):(c==w.Bool||c==w.Trigger)&&this.animator.setBool(this.animParamToDisable,!1)}}}update(){if(this.parameter&&this.valueLabel){var t="";this.parameter.type==w.Float||this.parameter.type==w.Int?t=this.parameter.value.toFixed(1):t=`${this.parameter.value}`,this.valueLabel.text=t}}}z([l(H)],J.prototype,"animator",2);z([l(Et)],J.prototype,"syncAnimator",2);z([l()],J.prototype,"animParam",2);z([l()],J.prototype,"animParamToDisable",2);z([l(O)],J.prototype,"valueLabel",2);class Dt extends m{constructor(){super(...arguments),this.animName=""}onPointerClick(t){this.animator&&this.syncAnimator&&this.animator.play(this.animName)}}z([l(H)],Dt.prototype,"animator",2);z([l(Et)],Dt.prototype,"syncAnimator",2);z([l()],Dt.prototype,"animName",2);const Bt=2,A=4,L=4,is=4,U=new Int32Array(2),ve=new Float32Array(U.buffer),we=new Float64Array(U.buffer),mt=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;class B{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?B.ZERO:new B(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}}B.ZERO=new B(0,0);var zt;(function(o){o[o.UTF8_BYTES=1]="UTF8_BYTES",o[o.UTF16_STRING=2]="UTF16_STRING"})(zt||(zt={}));class yt{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new yt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new B(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new B(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return U[0]=this.readInt32(t),ve[0]}readFloat64(t){return U[mt?0:1]=this.readInt32(t),U[mt?1:0]=this.readInt32(t+4),we[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){ve[0]=e,this.writeInt32(t,U[0])}writeFloat64(t,e){we[0]=e,this.writeInt32(t,U[mt?0:1]),this.writeInt32(t+4,U[mt?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+A+L)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<L;e++)t+=String.fromCharCode(this.readInt8(this.position_+A+e));return t}__offset(t,e){const i=t-this.readInt32(t);return e<this.readInt16(i)?this.readInt16(i+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const i=this.readInt32(t);let s="",n=0;if(t+=A,e===zt.UTF8_BYTES)return this.bytes_.subarray(t,t+i);for(;n<i;){let r;const a=this.readUint8(t+n++);if(a<192)r=a;else{const p=this.readUint8(t+n++);if(a<224)r=(a&31)<<6|p&63;else{const c=this.readUint8(t+n++);if(a<240)r=(a&15)<<12|(p&63)<<6|c&63;else{const b=this.readUint8(t+n++);r=(a&7)<<18|(p&63)<<12|(c&63)<<6|b&63}}}r<65536?s+=String.fromCharCode(r):(r-=65536,s+=String.fromCharCode((r>>10)+55296,(r&1024-1)+56320))}return s}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+A}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=L)throw new Error("FlatBuffers: file identifier must be length "+L);for(let e=0;e<L;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+A+e))return!1;return!0}createLong(t,e){return B.create(t,e)}createScalarList(t,e){const i=[];for(let s=0;s<e;++s)t(s)!==null&&i.push(t(s));return i}createObjList(t,e){const i=[];for(let s=0;s<e;++s){const n=t(s);n!==null&&i.push(n.unpack())}return i}}class ae{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=yt.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const i=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<i+t+e;){const s=this.bb.capacity();this.bb=ae.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(i)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,i){(this.force_defaults||e!=i)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,i){(this.force_defaults||e!=i)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,i){(this.force_defaults||e!=i)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,i){(this.force_defaults||!e.equals(i))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,i){(this.force_defaults||e!=i)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,i){e!=i&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=e<<1,s=yt.allocate(i);return s.setPosition(i-e),s.bytes().set(t.bytes(),i-e),s}addOffset(t){this.prep(A,0),this.writeInt32(this.offset()-t+A)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const i=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const s=2;this.addInt16(t-this.object_start);const n=(i+s)*Bt;this.addInt16(n);let r=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const p=this.bb.capacity()-this.vtables[e];if(n==this.bb.readInt16(p)){for(let c=Bt;c<n;c+=Bt)if(this.bb.readInt16(a+c)!=this.bb.readInt16(p+c))continue t;r=this.vtables[e];break}}return r?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,r-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,i){const s=i?is:0;if(e){const n=e;if(this.prep(this.minalign,A+L+s),n.length!=L)throw new Error("FlatBuffers: file identifier must be length "+L);for(let r=L-1;r>=0;r--)this.writeInt8(n.charCodeAt(r))}this.prep(this.minalign,A+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const i=this.bb.capacity()-t,s=i-this.bb.readInt32(i);if(!(this.bb.readInt16(s+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,i){this.notNested(),this.vector_num_elems=e,this.prep(A,t*e),this.prep(i,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let i=0;for(;i<t.length;){let s;const n=t.charCodeAt(i++);if(n<55296||n>=56320)s=n;else{const r=t.charCodeAt(i++);s=(n<<10)+r+(65536-56623104-56320)}s<128?e.push(s):(s<2048?e.push(s>>6&31|192):(s<65536?e.push(s>>12&15|224):e.push(s>>18&7|240,s>>12&63|128),e.push(s>>6&63|128)),e.push(s&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let i=0,s=this.space,n=this.bb.bytes();i<e.length;i++)n[s++]=e[i];return this.endVector()}createLong(t,e){return B.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let i=0;i<t.length;++i){const s=t[i];if(s!==null)e.push(this.createObjectOffset(s));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class v{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSendBuffer_Model(t,e){return(e||new v).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSendBuffer_Model(t,e){return t.setPosition(t.position()+is),(e||new v).__init(t.readInt32(t.position())+t.position(),t)}guid(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}guidLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}guidArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}dontSave(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}prefix(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}seconds(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt32(this.bb_pos+t):0}static startSendBuffer_Model(t){t.startObject(4)}static addGuid(t,e){t.addFieldOffset(0,e,0)}static createGuidVector(t,e){t.startVector(1,e.length,1);for(let i=e.length-1;i>=0;i--)t.addInt8(e[i]);return t.endVector()}static startGuidVector(t,e){t.startVector(1,e,1)}static addDontSave(t,e){t.addFieldInt8(1,+e,0)}static addPrefix(t,e){t.addFieldOffset(2,e,0)}static addSeconds(t,e){t.addFieldInt32(3,e,0)}static endSendBuffer_Model(t){return t.endObject()}static finishSendBuffer_ModelBuffer(t,e){t.finish(e)}static finishSizePrefixedSendBuffer_ModelBuffer(t,e){t.finish(e,void 0,!0)}static createSendBuffer_Model(t,e,i,s,n){return v.startSendBuffer_Model(t),v.addGuid(t,e),v.addDontSave(t,i),v.addPrefix(t,s),v.addSeconds(t,n),v.endSendBuffer_Model(t)}}var ns={exports:{}};(function(o,t){(function(e,i){o.exports=i()})(Es,function(){return function(e){var i={};function s(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=i,s.d=function(n,r,a){s.o(n,r)||Object.defineProperty(n,r,{enumerable:!0,get:a})},s.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},s.t=function(n,r){if(1&r&&(n=s(n)),8&r||4&r&&typeof n=="object"&&n&&n.__esModule)return n;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:n}),2&r&&typeof n!="string")for(var p in n)s.d(a,p,function(c){return n[c]}.bind(null,p));return a},s.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return s.d(r,"a",r),r},s.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},s.p="",s(s.s=0)}([function(e,i,s){s.r(i),s.d(i,"UuidTool",function(){return a}),s.d(i,"Uuid",function(){return r});var n={uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i},r=function(){function p(c){this.id="",typeof c=="string"?this.fromString(c):Array.isArray(c)?this.fromBytes(c):this.generate()}return p.fromJson=function(c){if(typeof c=="string"&&(c=JSON.parse(c)),!c||!c.id)throw new TypeError("The input cannot be converted to Uuid.");return new p(c.id)},p.prototype.generate=function(){var c=new Array(16).fill(0).map(function(){return 256*Math.random()&255});return c[6]=79&(64|c[6]),this.fromBytes(c),this},p.prototype.fromBytes=function(c){return this.id=c.map(function(b){return("00"+b.toString(16)).slice(-2)}).join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5"),this.id=this.toString(),this},p.prototype.toBytes=function(){return(this.id.replace(/-/g,"").match(/.{2}/g)||[]).map(function(c){return parseInt(c,16)})},p.prototype.fromString=function(c){return this.id=c.trim(),this.id=this.toString(),this},p.prototype.toString=function(){switch(p.stringExportFormat){default:case"lowercase":return this.id.toLowerCase();case"uppercase":return this.id.toUpperCase()}},p.prototype.isValid=function(){return typeof this.id=="string"&&this.id.length===36&&n.uuid.test(this.id)},p.prototype.equals=function(c){return typeof c=="string"&&(c=new p(c)),this.toString()===c.toString()},p.stringExportFormat="lowercase",p}(),a=function(){function p(){}return p.toBytes=function(c){return new r().fromString(c).toBytes()},p.toString=function(c){return new r().fromBytes(c).toString()},p.newUuid=function(){return new r().toString()},p.isUuid=function(c){return new r().fromString(c).isValid()},p.compare=function(c,b){return new r(c).equals(new r(b))},p}()}])})})(ns);var Mn=ns.exports,Ln=Object.defineProperty,Fn=Object.getOwnPropertyDescriptor,Rt=(o,t,e,i)=>{for(var s=i>1?void 0:i?Fn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Ln(t,e,s),s};const ut="MESG";Ds(ut,v.getRootAsSendBuffer_Model);class lt extends m{constructor(){super(...arguments),this.saveState=!0,this.recieveBuffer=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix()} ${t.seconds()}`)}}onEnable(){this.context.connection.beginListenBinary(ut,this.recieveBuffer)}onDisable(){this.context.connection.stopListenBinary(ut,this.recieveBuffer)}sendBuffer(){const t=new ae(0),e=v.createGuidVector(t,Mn.UuidTool.toBytes(this.guid)),i=!this.saveState,s=t.createString("Hello, it is "),n=Math.floor(this.context.time.time);console.log(e),v.startSendBuffer_Model(t),v.addGuid(t,e),v.addDontSave(t,i),v.addPrefix(t,s),v.addSeconds(t,n);const r=v.endSendBuffer_Model(t);t.finish(r,ut);const a=t.asUint8Array();this.context.connection.sendBinary(a),this.outgoingSizeLabel&&(this.outgoingSizeLabel.text=`${a.length} bytes`)}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}Rt([l(O)],lt.prototype,"msgLabel",2);Rt([l(O)],lt.prototype,"saveStateLabel",2);Rt([l(O)],lt.prototype,"outgoingSizeLabel",2);Rt([l()],lt.prototype,"saveState",2);var Bn=Object.defineProperty,Vn=Object.getOwnPropertyDescriptor,$t=(o,t,e,i)=>{for(var s=i>1?void 0:i?Vn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Bn(t,e,s),s};class ct extends m{constructor(){super(...arguments),this.saveState=!0,this.msgId="SendMessage",this.recieveMessage=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix} ${t.seconds}`)}}onEnable(){this.context.connection.beginListen(this.msgId,this.recieveMessage)}onDisable(){this.context.connection.stopListen(this.msgId,this.recieveMessage)}sendMessage(){const t={guid:this.guid,dontSave:!this.saveState,prefix:"Hello, it is ",seconds:Math.floor(this.context.time.time)};if(this.context.connection.send(this.msgId,t),this.outgoingSizeLabel){const e=new TextEncoder().encode(JSON.stringify(t));this.outgoingSizeLabel.text=`${e.length} bytes`}}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}$t([l(O)],ct.prototype,"msgLabel",2);$t([l(O)],ct.prototype,"saveStateLabel",2);$t([l(O)],ct.prototype,"outgoingSizeLabel",2);$t([l()],ct.prototype,"saveState",2);var Un=Object.defineProperty,Nn=Object.getOwnPropertyDescriptor,zn=(o,t,e,i)=>{for(var s=i>1?void 0:i?Nn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Un(t,e,s),s};class rs extends m{constructor(){super(...arguments),this.msgId="EventListOnClick",this.model=new Wn}onEnable(){this.onClickMsgHandler=this.handleOnClickMsg.bind(this),this.context.connection.beginListen(this.msgId,this.onClickMsgHandler)}onDisable(){this.context.connection.stopListen(this.msgId,this.onClickMsgHandler)}handleOnClickMsg(t){t.id===this.guid&&this.callEventList()}onPointerClick(t){this.callEventList(),this.model.id=this.guid,this.context.connection.send(this.msgId,this.model)}callEventList(){var t;(t=this.onClicked)==null||t.invoke()}}zn([l(x)],rs.prototype,"onClicked",2);class Wn{constructor(){this.id=""}}var Gn=Object.defineProperty,Hn=Object.getOwnPropertyDescriptor,Xn=(o,t,e,i)=>{for(var s=i>1?void 0:i?Hn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Gn(t,e,s),s};class os extends m{constructor(){super(...arguments),this.updateLabel=()=>{this.label&&this.playerState&&(this.label.text=`${this.playerState.owner}
${this.playerState.isLocalPlayer?"<color=#ff715e>Local</color>":"Remote"}`)}}start(){this.playerState=this.gameObject.getComponentInParent(je),this.playerState&&(this.playerState.hasOwner?this.updateLabel():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.updateLabel))}}Xn([l(O)],os.prototype,"label",2);var qn=Object.defineProperty,Yn=Object.getOwnPropertyDescriptor,Tt=(o,t,e,i)=>{for(var s=i>1?void 0:i?Yn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&qn(t,e,s),s};class ht extends m{constructor(){super(...arguments),this.speed=5,this.currentGoal=new _,this.pointerPos=new F,this.tempVec1=new _,this.tempVec2=new _,this.initialize=()=>{var i;if(!this.playerState||!this.mainRenderer)return;this.syncedTransform&&((i=this.playerState)!=null&&i.isLocalPlayer)&&this.syncedTransform.requestOwnership();const t=this.playerState.owner??"",e=this.mainRenderer.sharedMaterial;if(e){const s=new Ee;s.copy(e);const n=parseInt(t,16);s.color=new et(n),this.mainRenderer.sharedMaterial=s}}}start(){this.playerState&&(this.playerState.hasOwner?this.initialize():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.initialize),this.currentGoal.copy(this.gameObject.position))}update(){var t;if((t=this.playerState)!=null&&t.isLocalPlayer){const e=this.context.input,i=this.context.mainCamera,s=this.context.time.deltaTime,n=this.context.physics.engine;this.tempVec1.copy(this.currentGoal),this.tempVec2.copy(this.gameObject.position);const r=this.tempVec1.sub(this.tempVec2),a=this.speed*s;r.length()<a?this.gameObject.position.copy(this.currentGoal):this.gameObject.translateOnAxis(r.normalize(),a);const p=!1;if(e.getPointerDown(0)){const c=e.getPointerPosition(0);c&&this.pointerPos.copy(c)}if(e.getPointerUp(0)&&i&&((e.getPointerPosition(0)||new F).distanceTo(this.pointerPos)<40||p)){const b=n.raycast();b&&b.collider&&this.currentGoal.copy(b.point)}}}}Tt([l(je)],ht.prototype,"playerState",2);Tt([l(Rs)],ht.prototype,"syncedTransform",2);Tt([l(q)],ht.prototype,"mainRenderer",2);Tt([l()],ht.prototype,"speed",2);var Jn=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,le=(o,t,e,i)=>{for(var s=i>1?void 0:i?Qn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Jn(t,e,s),s};const Kn=G("debugspawnhandler");class At extends m{constructor(){super(...arguments),this.spawnPoints=[],this.validIndex=-1,this.offsetForError=1,this.downVector=new _(0,-1,0),this.upVector=new _(0,1,0),this.offsetVector=new _}handlePlayerSpawn(t){const e=new $s;e.layerMask=new Fs,e.layerMask.enableAll(),e.ray=new Bs(new _,this.downVector.clone()),e.maxDistance=2;let i;this.validIndex+1>=this.spawnPoints.length?this.validIndex=0:this.validIndex++;for(let r=this.validIndex;r<this.spawnPoints.length;r++){const a=this.spawnPoints[r];if(a.getWorldPosition(e.ray.origin),e.ray.origin.y+=3,e.ray.direction.copy(this.downVector),Kn&&Gt.DrawLine(e.ray.origin,e.ray.origin.clone().add(e.ray.direction.clone().multiplyScalar(e.maxDistance)),16711680,50,!0),this.context.physics.raycast(e).length==0){i=a,this.validIndex=r;break}}i||console.log("No available spawn");const s=(i==null?void 0:i.position.clone())||new _,n=(i==null?void 0:i.rotation.clone())||new Vs;this.offsetVector.set(0,0,this.offsetForError),this.offsetVector.applyAxisAngle(this.upVector,Math.random()*Math.PI*2),s.add(this.offsetVector),t instanceof M&&(t.worldToLocal(s),t.position.copy(s),t.rotation.copy(n))}}le([l(M)],At.prototype,"spawnPoints",2);le([X()],At.prototype,"validIndex",2);le([l()],At.prototype,"offsetForError",2);var Zn=Object.defineProperty,kn=Object.getOwnPropertyDescriptor,ce=(o,t,e,i)=>{for(var s=i>1?void 0:i?kn(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&Zn(t,e,s),s};class st extends m{constructor(){super(...arguments),this.model=new tr}awake(){this.onModelChanged()}updateUser(){var e;this.model.guid=this.guid;let t=this.model.users.find(i=>i.userId==this.context.connection.connectionId);t||(t=new er,this.model.users.push(t)),t.userId=this.context.connection.connectionId,t.nickname=(e=this.inputField)==null?void 0:e.text,this.model=this.model}onModelChanged(){if(j("Room data recieved"),this.displayLabel){const t=this.model.users.map(e=>`${e.nickname}`).join(`
`);this.displayLabel.text=t.length>0?t:"no data"}}}ce([X(st.prototype.onModelChanged)],st.prototype,"model",2);ce([l(O)],st.prototype,"displayLabel",2);ce([l(Ie)],st.prototype,"inputField",2);class tr{constructor(){this.guid="",this.users=[]}}class er{constructor(){this.userId="",this.nickname=""}}var sr=Object.defineProperty,ir=Object.getOwnPropertyDescriptor,he=(o,t,e,i)=>{for(var s=i>1?void 0:i?ir(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&sr(t,e,s),s};class Mt extends m{update(){var a;if((a=this.gameObject.getComponent(V))==null||a.lockPositionX,!this.roomLabel||!this.usersLabel)return;const t=this.context.connection,e=t.currentRoomName||"",i=t.connectionId||"",s=t.currentRoomViewId||"";this.roomLabel.text=t.isInRoom?`Joined:
${e}
(${i}) (${s})
${t.currentLatency.toFixed(2)}ms`:"Not in a room";const n=t.usersInRoom().join(`
`),r=n.length>0?n:"no users";this.usersLabel.text=t.isInRoom?r:""}joinRoom(){const t=this.context.connection;this.roomNameInput&&(t.isInRoom?j("You are already in a room, you have to leave it first!",Oe.Warn):t.joinRoom(this.roomNameInput.text))}disconnectRoom(){const t=this.context.connection;t.isInRoom&&t.leaveRoom()}}he([l(O)],Mt.prototype,"roomLabel",2);he([l(O)],Mt.prototype,"usersLabel",2);he([l(Ie)],Mt.prototype,"roomNameInput",2);d.add("SyncedAnimator",Et);d.add("SyncedAnimatorControls_RandomValue",J);d.add("SyncedAnimatorControls_PlayAnim",Dt);d.add("SendBufferExample",lt);d.add("SendBuffer_Model",v);d.add("SendMessageExample",ct);d.add("TriggerEventListOnClick",rs);d.add("PlayerStateUI",os);d.add("SampleNetworkedPlayer",ht);d.add("SpawnSpotHandler",At);d.add("RoomData",st);d.add("RoomManager",Mt);var nr=Object.defineProperty,rr=Object.getOwnPropertyDescriptor,or=(o,t,e,i)=>{for(var s=i>1?void 0:i?rr(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&nr(t,e,s),s};class pe extends m{constructor(){super(...arguments),this.controls=null}onEnable(){this.controls=y.findObjectOfType(vt)}setView(){!this.controls||!this.lookAt||(this.controls.setLookTargetPosition(Y(this.lookAt)),this.controls.setCameraTargetPosition(Y(this.gameObject)))}}or([l(y)],pe.prototype,"lookAt",2);var ar=Object.defineProperty,lr=Object.getOwnPropertyDescriptor,as=(o,t,e,i)=>{for(var s=i>1?void 0:i?lr(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&ar(t,e,s),s};class de extends m{constructor(){super(...arguments),this.centerPoints=[],this.camPos=new _,this.currentCenterPoint=null,this.startX=0,this.startTime=0}template(){return`
            <div>
                <div class="spatial-audio-ui">
                    <button class="left"></button>
                    <p class="name">Instrument</p>
                    <span>Swipe or tap to change</span>
                    <button class="right"></button>
                </div>

                <div class="explainer">
                    <div>
                        <h1 class="ignore-landscape">Spatial Audio</h1>
                        <p>Sound on! </p>
                        <p>This sample demonstrates how to use spatial audio in <a href="https://needle.tools">Needle Engine</a>. Audio sources can be placed in 3D, and your camera position influences how loud they are.</p>
                        <p>You can move around the scene in the browser, open the page on your phone and try it in Augmented Reality, or in Virtual Reality on a VR headset.</p>
                        <button class="start">Start exploring</button><br class="ignore-landscape"/>
                    </div>
                </div>
            </div>
        `}style(){return`
            .spatial-audio-ui {
                position: absolute;
                top: 50px;
                left: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                transform: translateX(-50%);
                vertical-align: middle;
                min-width: 100%; /* to avoid text wrapping */
            }

            .spatial-audio-ui button {
                outline: none;
                border: none;
                background: none;
                font-size: 4rem;
                color: white;
                transition: transform 0.2s;
            }

            .spatial-audio-ui button:hover {
                cursor: pointer;
                transform: scale(1.4);
            }

            .spatial-audio-ui span {
                position: absolute;
                font-size: 1rem;
                color: white;
                opacity: 0.3;
                top: 0px;
                text-align: center;
            }

            .spatial-audio-ui p {
                font-size: 2rem;
                color: white;
                margin: 0 1rem;
                margin-top: 0.6rem;
                text-transform: uppercase;
                text-align: center;
                position: relative;
            }

            .explainer {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                text-align: center;
                color: white;
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .explainer h1 {
                text-transform: uppercase;
                font-weight: 400;
            }

            .explainer > div {
                max-width: min(94vw, 500px);
            }

            .explainer a {
                color: #b9f026;
                text-decoration: none;
                white-space: nowrap;
            }

            .explainer button, .explainer a.button {
                background: white;
                color: black;
                border: none;
                padding: 1rem 2rem;
                font-size: 1rem;
                outline: none;
                transition: transform 0.2s;
                border-radius: 0.5rem;
                margin: 2rem;
            }

            .explainer button.small, .explainer a.button.small {
                padding: 0.5rem 2rem;
                background: #ccc;
            }

            .explainer button:hover, .explainer a.button:hover {
                cursor: pointer;
                transform: scale(1.1);
            }

            @media (max-height: 450px) {
                .ignore-landscape {
                    display: none;
                }
            }

            span {
                text-overflow: ;
            }
        `}onEnable(){var e,i,s,n,r;const t=document.createElement("template");t.innerHTML=this.template(),this.element=(e=t.content.firstElementChild)==null?void 0:e.cloneNode(!0),this.styleElement=document.createElement("style"),this.styleElement.innerHTML=this.style(),this.context.appendHTMLElement(this.element),this.context.appendHTMLElement(this.styleElement),(i=this.element.querySelector(".left"))==null||i.addEventListener("click",()=>{this.changeIndex(-1)}),(s=this.element.querySelector(".right"))==null||s.addEventListener("click",()=>{this.changeIndex(1)}),(n=this.element.querySelector(".name"))==null||n.addEventListener("click",()=>{this.changeIndex(1)}),(r=this.element.querySelector(".start"))==null||r.addEventListener("click",()=>{var a,p;(p=(a=this.element)==null?void 0:a.querySelector(".explainer"))==null||p.remove()}),this._touchstart=this.touchstart.bind(this),this.context.domElement.addEventListener("pointerdown",this._touchstart),this._touchend=this.touchend.bind(this),this.context.domElement.addEventListener("pointerup",this._touchend),this._keydown=this.keydown.bind(this),document.addEventListener("keydown",this._keydown)}changeIndex(t){let e=this.centerPoints.indexOf(this.currentCenterPoint);e+=t,e>=this.centerPoints.length&&(e=0),e<0&&(e=this.centerPoints.length-1),this.centerPoints[e].setView()}onDisable(){var t,e;(t=this.element)==null||t.remove(),(e=this.styleElement)==null||e.remove(),this.context.domElement.removeEventListener("pointerdown",this._touchstart),this.context.domElement.removeEventListener("pointerup",this._touchend)}update(){this.orbitControls&&this.orbitControls.controls&&(this.camPos=this.orbitControls.controls.target);let t=null,e=1/0;for(const i of this.centerPoints){if(!(i!=null&&i.gameObject))continue;const n=Y(i.gameObject).distanceTo(this.camPos);n<e&&(t=i,e=n)}t!==this.currentCenterPoint&&t&&(this.currentCenterPoint=t,this.element&&t.gameObject.parent&&(this.element.querySelector(".name").textContent=t.gameObject.parent.name))}touchstart(t){this.startX=t.clientX,this.startTime=Date.now()}touchend(t){const i=t.clientX-this.startX;Date.now()-this.startTime<250&&Math.abs(i)>20&&(i>0?this.changeIndex(-1):this.changeIndex(1))}keydown(t){t.code==="ArrowLeft"||t.code==="KeyA"?this.changeIndex(-1):(t.code==="ArrowRight"||t.code==="KeyD")&&this.changeIndex(1)}}as([l(pe)],de.prototype,"centerPoints",2);as([l(vt)],de.prototype,"orbitControls",2);d.add("OrbitControlsView",pe);d.add("SpatialAudioUI",de);var cr=Object.defineProperty,hr=Object.getOwnPropertyDescriptor,pr=(o,t,e,i)=>{for(var s=i>1?void 0:i?hr(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&cr(t,e,s),s};class ls extends m{onPointerClick(){this.shake()}shake(){this.animator&&this.animator.setTrigger("shake")}}pr([l(H)],ls.prototype,"animator",2);var dr=Object.defineProperty,mr=Object.getOwnPropertyDescriptor,ur=(o,t,e,i)=>{for(var s=i>1?void 0:i?mr(t,e):t,n=o.length-1,r;n>=0;n--)(r=o[n])&&(s=(i?r(t,e,s):r(s))||s);return i&&s&&dr(t,e,s),s};class cs extends m{update(){if(this.label){const t=new Date;this.label.text=`${t.getHours()}:${this.padTo2Digits(t.getMinutes())}`}}padTo2Digits(t){return t.toString().padStart(2,"0")}}ur([l(O)],cs.prototype,"label",2);d.add("PhoneControoler",ls);d.add("TimeUI",cs);
